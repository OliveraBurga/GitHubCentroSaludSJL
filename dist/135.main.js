"use strict";(self.webpackChunkpoliclinico=self.webpackChunkpoliclinico||[]).push([[135],{135:(e,a,n)=>{let t,i;n.r(a),n.d(a,{default:()=>l});let o={render:async e=>{$("#main").off(),e.innerHTML='\n\n        <div id="main">\n            \x3c!-- Content Header (Page header) --\x3e\n            <section class="content-header">\n                <div class="row">\n                    <div class="col-md-8 content-header" style="padding-top:5px;">\n                        <h1 style="margin:0; ">\n                            Locales Anexos\n                            <small>Configuración</small>\n                        </h1>\n                    </div>\n                    <div class="col-md-4" align="right">\n                        <button type="button" class="btn btn-sm btn-warning" name="nuevo"><i class="fa fa-plus"></i> Nuevo</button>\n                    </div>\n                </div>\n                </section>\n\n                \x3c!-- Main content --\x3e\n                <section class="content">\n\n                \x3c!-- Default box --\x3e\n                <div class="box box-warning">\n                    <div class="box-body">\n                    <div class="table-responsive">\n                        <table name="registros" class="table table-striped nowrap" style="width:100%;"></table>\n                    </div>\n                    </div>\n                </div>\n                \x3c!-- /.box --\x3e\n\n            </section>\n            \x3c!-- /.content --\x3e\n \n            \x3c!-- MODAL SAVE --\x3e\n            <div class="modal inmodal fade" name="modal-save" data-backdrop="static"  role="dialog" aria-hidden="true">\n                <div class="modal-dialog">\n                    <div class="modal-content">\n                        <div class="modal-header">\n                            <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>\n                            <h4 name="save" class="modal-title">Modal title</h4>\n                        </div>\n                        <form name="save">\n                            <div class="modal-body" style="max-height:'+(window.innerHeight-200)+'px; overflow:auto;">\n                                <div class="nav-tabs-custom">\n                                    <ul class="nav nav-tabs">\n                                        <li class="active"><a href="#local-basico" data-toggle="tab" aria-expanded="true">Básico</a></li>\n                                        <li class=""><a href="#local-facturacion" data-toggle="tab" aria-expanded="false">Comprobantes / Series</a></li>\n                                        <li class=""><a href="#local-facturacion_electronica" data-toggle="tab" aria-expanded="false">Facturación Electrónica</a></li>\n                                    </ul>\n                                    <div class="tab-content">\n                                        <div class="tab-pane active" id="local-basico">\n                                            <div class="row"> \n                                                <div class="col-md-4">\n                                                    <div class="form-group">\n                                                        <label>Tipo <span class="text-red">(*)</span></label>\n                                                        <input type="text" name="tipo" class="form-control" autocomplete="off" list="list-tipo">\n                                                        <datalist id="list-tipo">\n                                                            <option value="SUCURSAL" />\n                                                            <option value="SEDE" />\n                                                            <option value="FILIAL" />\n                                                        </datalist>\n                                                    </div>\n                                                </div>\n                                                <div class="col-md-8">\n                                                    <div class="form-group">\n                                                        <label>Nombre <span class="text-red">(*)</span></label>\n                                                        <input type="text" name="nombre" class="form-control" autocomplete="off">\n                                                    </div>\n                                                </div>  \n                                                <div class="col-md-12">\n                                                    <div class="form-group">\n                                                        <label>Dirección <span class="text-red">(*)</span></label>\n                                                        <input type="text" name="direccion" class="form-control" autocomplete="off">\n                                                    </div>\n                                                </div>                                                \n                                                <div class="col-md-6">\n                                                    <div class="form-group">\n                                                        <label>Teléfono </label>\n                                                        <input type="text" name="telefono" class="form-control" autocomplete="off">\n                                                    </div>\n                                                </div>                                                \n                                                <div class="col-md-6">\n                                                    <div class="form-group">\n                                                        <label>Límite Máximo Saldo en Caja chica S/.</label>\n                                                        <input type="number" step="any" name="limite_maximo_saldo_caja_chica" class="form-control" autocomplete="off">\n                                                    </div>\n                                                </div>\n                                            </div>  \n                                        </div>\n                                        <div class="tab-pane" id="local-facturacion">\n                                            <div class="row">     \n                                                <div class="col-md-12">\n                                                    <div class="form-group">\n                                                        <label>Formato Impresión de Comprobantes<span class="text-red">(*)</span></label>\n                                                        <select class="form-control select" name="formato_impresion">\n                                                            <option value="">Seleccione...</option>\n                                                            <option value="TICKET">TICKET</option>\n                                                            <option value="A4">A4/A5</option>\n                                                        </select>\n                                                    </div>\n                                                </div>                                            \n                                                <div class="col-md-6">\n                                                    <div class="form-group">\n                                                        <label>Serie Órden de Servicio <span class="text-red">(*)</span></label>\n                                                        <input type="text" name="serie_orden" class="form-control" placeholder="OS01" autocomplete="off">\n                                                    </div>\n                                                </div>\n                                                <div class="col-md-6">\n                                                    <div class="form-group">\n                                                        <label>Serie Manifiesto <span class="text-red">(*)</span></label>\n                                                        <input type="text" name="serie_manifiesto" class="form-control" placeholder="MF01" autocomplete="off">\n                                                    </div>\n                                                </div>\n                                                <div class="col-md-6">\n                                                    <div class="form-group">\n                                                        <label>Serie Desembarque <span class="text-red">(*)</span></label>\n                                                        <input type="text" name="serie_desembarque" class="form-control" placeholder="DS01" autocomplete="off">\n                                                    </div>\n                                                </div>\n                                                <div class="col-md-6">\n                                                    <div class="form-group">\n                                                        <label>Serie Reparto <span class="text-red">(*)</span></label>\n                                                        <input type="text" name="serie_reparto" class="form-control" placeholder="RP01" autocomplete="off">\n                                                    </div>\n                                                </div>                                                \n                                                <div class="col-md-12">\n                                                    <table class="table">\n                                                        <thead>\n                                                            <tr>\n                                                                <th>TIPO COMPROBANTE</th>\n                                                                <th>SERIE</th>\n                                                                <th>NÚMERO</th>\n                                                            </tr>\n                                                        </thead>\n                                                        <tbody name="detalle-serie_facturacion"></tbody>\n                                                        <tfoot>\n                                                            <tr>\n                                                                <th><button type="button" class="btn btn-default btn-sm" name="nuevo_serie_facturacion"><i class="fa fa-plus"></i> Agregar Nuevo</button></th>\n                                                            </tr>\n                                                        </tfoot>\n                                                    </table>\n                                                </div>\n                                            </div>  \n                                        </div>   \n                                        <div class="tab-pane" id="local-facturacion_electronica">\n                                            <div class="row">   \n                                                <div class="col-md-12">\n                                                    <div class="form-group">\n                                                        <label><input type="checkbox" name="fl_facturacion" autocomplete="off"> Facturación Electrónica </label>                                            \n                                                    </div>\n                                                </div>                                                \n                                                <div class="col-md-6">\n                                                    <div class="form-group">\n                                                        <label>Código de Establecimiento (SUNAT) <span class="text-red">(*)</span></label>\n                                                        <input type="text" name="codigo_sunat" class="form-control" autocomplete="off" placeholder="0000">\n                                                    </div>\n                                                </div> \n                                                <div class="col-md-6">\n                                                    <div class="form-group">\n                                                        <label>Tipo Afectación <span class="text-red">(*)</span></label>\n                                                        <select name="tipo_afectacion_igv" class="form-control" autocomplete="off">\n                                                            <option value="">Seleccione...</option>\n                                                            <option value="GRAVADO">GRAVADO ONEROSO</option>\n                                                            <option value="EXONERADO">EXONERADO ONEROSO</option>\n                                                        </select>\n                                                    </div>\n                                                </div>    \n                                                <div class="col-md-12">\n                                                    <div class="form-group">\n                                                        <label>Texto en parte inferior de factura </label>\n                                                        <input type="text" name="texto_bottom_factura" class="form-control" autocomplete="off">\n                                                    </div>\n                                                </div>   \n                                                <div class="col-md-12">\n                                                    <div class="form-group">\n                                                        <label>TOKEN PSE </label>\n                                                        <input type="text" name="token_pse" class="form-control mayus_false" data-mayus="false" autocomplete="off">\n                                                    </div>\n                                                </div>\n                                            </div>  \n                                        </div>                                        \n                                    </div>\n                                </div>\n                                                            \n                            </div>\n                            <div class="modal-footer" align="center" style="display:block">\n                                <button type="button" name="cerrar" class="btn btn-white pull-left" data-dismiss="modal">Cerrar</button>\n                                <button type="submit" name="submit" class="btn btn-primary">Guardar</button>\n                            </div>\n                        </form>\n                    </div>\n                </div>\n            </div>\n\n            \x3c!-- MODAL DELETE --\x3e\n            <div class="modal inmodal fade" name="modal-delete" data-backdrop="static" tabindex="-1" role="dialog" aria-hidden="true">\n                <div class="modal-dialog modal-sm">\n                    <div class="modal-content">\n                        <div class="modal-header">\n                            <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button>\n                            <h4 name="delete" class="modal-title">Modal title</h4>\n                        </div>\n                        <form name="delete">\n                            <div class="row">\n                                <div class="col-md-12" align="center">\n                                    <i class="fad fa-trash-alt fa-4x"></i><br/>\n                                </div>\n                                <div class="col-md-12"  align="center" style="padding-top:10px;">\n                                    <label><input type="checkbox" name="confirmacion" required/>\n                                        Confirmo realizar la eliminación</label>\n                                    <p style="color:red;">Esta acción no se podrá revertir</p>\n                                </div>\n                                <div class="col-md-12" name="texto" align="center">\n\n                                </div>\n                            </div>\n                            <div class="modal-footer" align="center" style="display:block" >\n                                <button type="button" name="cerrar" class="btn btn-white" data-dismiss="modal">Cerrar</button>\n                                <button type="submit" name="submit" class="btn btn-danger">Eliminar Ahora!</button>\n                            </div>\n                        </form>\n                    </div>\n                </div>\n            </div>\n        \n\n        </div>            \n        ',await o.after_render()},after_render:async()=>{i="#main",t=$(i),t.find('form[name="save"]').validate({rules:{tipo:{required:!0},nombre:{required:!0},codigo_sunat:{required:!0},tipo_afectacion_igv:{required:!0},serie_orden:{required:!0},serie_manifiesto:{required:!0},serie_desembarque:{required:!0},serie_reparto:{required:!0},formato_impresion:{required:!0}},messages:{tipo:"Tipo",nombre:"Nombre del Gasto",codigo_sunat:"Código SUNAT",tipo_afectacion_igv:"Tipo de afectación IGV",serie_orden:"Serie Orden de Servicio",serie_manifiesto:"Serie de Manifiestos",serie_desembarque:"Serie de Desembarque",serie_reparto:"Serie de Reparto",formato_impresion:"Formato de Impresión"},submitHandler:function(){o.submit()}}),t.find('form[name="delete"]').validate({submitHandler:function(){o.submit()}}),t.on("click",'button[name="nuevo"]',(function(e){e.stopImmediatePropagation(),o.new()})),t.on("click",'button[name="row-edit"]',(function(e){e.stopImmediatePropagation(),o.edit($(this))})),t.on("click",'a[name="row-delete"]',(function(e){e.stopImmediatePropagation(),o.delete($(this))})),t.on("click",'input[name="fl_facturacion"]',(function(e){e.stopImmediatePropagation(),o.change_facturacion()})),t.on("click",'button[name="nuevo_serie_facturacion"]',(function(e){e.stopImmediatePropagation(),o.agregar_serie_facturacion()})),o.datatable(),await o.get_comprobante(),HELPER.load_component()},id:null,action_submit:null,get_comprobante:async()=>{axios.get(BASE_API+"recursos/data_static/comprobante").then((function(e){o.array_comprobante=e.data})).catch((e=>{console.log(e)}))},agregar_serie_facturacion:(e=null)=>{let a=Math.random().toString(36).substr(2);null==e&&(e={id:"",id_comprobante:"",serie:"",numero_inicial:""});let n="";o.array_comprobante.forEach((e=>{n+='<option value="'+e.id+'">'+e.text+"</option>"}));let i='\n            <tr data-codigo="'+a+'">\n                <td style="display:none;"><input type="hidden" data-name="id" style="width:150px;" value="'+e.id+'"/></td>\n                <td><select data-name="id_comprobante" style="width:250px;" class="form-control">'+n+'</select></td>\n                <td><input type="text" data-name="serie"  class="form-control" value="'+e.serie+'" /></td>\n                <td><input type="number" step="any" data-name="numero_inicial"  class="form-control" value="'+e.numero_inicial+'" /></td>\n                <td><button type="button" onclick="$(\'tr[data-codigo='+a+']\').remove();"class="btn btn-danger"><i class="fa fa-times"></i></button></td>\n            </tr>\n        ';t.find('tbody[name="detalle-serie_facturacion"]').append(i),t.find('tr[data-codigo="'+a+'"] select[data-name="id_comprobante"]').val(e.id_comprobante)},get_datajson_serie_facturacion:()=>{let e=[];return t.find('tbody[name="detalle-serie_facturacion"] tr').each((function(){let a={id:$(this).find('input[data-name="id"]').val(),id_comprobante:$(this).find('select[data-name="id_comprobante"]').val(),serie:$(this).find('input[data-name="serie"]').val(),numero_inicial:$(this).find('input[data-name="numero_inicial"]').val()};e.push(a)})),e},change_facturacion:()=>{t.find('input[name="fl_facturacion"]').is(":checked")?(t.find('input[name="codigo_sunat"]').prop("disabled",!1),t.find('input[name="token_pse"]').prop("disabled",!1),t.find('select[name="tipo_afectacion_igv"]').prop("disabled",!1),t.find('input[name="texto_bottom_factura"]').prop("disabled",!1)):(t.find('input[name="codigo_sunat"]').prop("disabled",!0),t.find('input[name="token_pse"]').prop("disabled",!0),t.find('select[name="tipo_afectacion_igv"]').prop("disabled",!0),t.find('input[name="texto_bottom_factura"]').prop("disabled",!0))},datatable:function(){this.table=t.find('table[name="registros"]').DataTable({ajax:BASE_API+"configuracion/local",columns:[{title:"ACCIÓN",render:function(e,a,n){return'\n                            <div class="btn-group" style="width:110px;">\n                                <button type="button" class="btn btn-default btn-sm" name="row-edit">EDITAR</button>     \n                                <button type="button" class="btn btn-default btn-sm dropdown-toggle" data-toggle="dropdown">\n                                      <i class="fa fa-angle-down"></i>\n                                </button>\n                                <ul class="dropdown-menu dropdown-menu-left" role="menu">\n                                    <li><a class="dropdown-item" name="row-delete" href="javascript:"><i class="far fa-trash-alt"></i> Eliminar</a></li>\n                                </ul>\n                            </div>\n                        '}},{title:"TIPO",render:function(e,a,n){let t="default";switch(n.tipo){case"SUCURSAL":t="primary";break;case"SEDE":t="success";break;case"FILIAL":t="info"}return'<small class="label label-'+t+'">'+n.tipo+"</small>"}},{title:"NOMBRE",mData:"nombre"},{title:"DIRECCIÓN",mData:"direccion"},{title:"FORMATO",mData:"formato_impresion"},{title:"S. ORDEN",mData:"serie_orden"},{title:"S. MANIFIESTO",mData:"serie_manifiesto"},{title:"S. DESEMBARQUE",mData:"serie_desembarque"},{title:"S. REPARTO",mData:"serie_reparto"},{title:"SERIES DE FACTURACIÓN",render:function(e,a,n){let t='<table class="table">';return n.series.forEach((e=>{t+="\n                            <tr>\n                                <td>"+e.comprobante+"</td>\n                                <td>"+e.serie+"-"+e.numero_inicial+"</td>\n                            </tr>\n                        "})),t+="</table>",t},visible:!1},{title:"CÓDIGO SUNAT",mData:"codigo_sunat",visible:!1},{title:"TOKEN PSE",mData:"token_pse",visible:!1}]})},new:function(){let e=t.find('form[name="save"]');t.find('h4[name="save"]').text("Nueva Local"),HELPER.reset_form(e),this.id=null,this.action_submit="save",this.change_facturacion(),t.find('tbody[name="detalle-serie_facturacion"').html(""),t.find('div[name="modal-save"]').modal("show")},edit:function(e){let a=t.find('form[name="save"]');t.find('h4[name="save"]').text("Editar Local"),HELPER.reset_form(a),t.find('tbody[name="detalle-serie_facturacion"').html("");let n=HELPER.get_attr_json(e);a.find('input[name="tipo"]').val(n.tipo),a.find('input[name="nombre"]').val(n.nombre),a.find('input[name="direccion"]').val(n.direccion),a.find('input[name="fl_facturacion"]').prop("checked",parseInt(n.fl_facturacion)),a.find('input[name="codigo_sunat"]').val(n.codigo_sunat),a.find('input[name="token_pse"]').val(n.token_pse),a.find('select[name="tipo_afectacion_igv"]').val(n.tipo_afectacion_igv).change(),a.find('input[name="serie_orden"]').val(n.serie_orden),a.find('input[name="serie_manifiesto"]').val(n.serie_manifiesto),a.find('input[name="texto_bottom_factura"]').val(n.texto_bottom_factura),a.find('input[name="telefono"]').val(n.telefono),a.find('input[name="serie_desembarque"]').val(n.serie_desembarque),a.find('input[name="serie_reparto"]').val(n.serie_reparto),a.find('select[name="formato_impresion"]').val(n.formato_impresion).change(),a.find('input[name="limite_maximo_saldo_caja_chica"]').val(n.limite_maximo_saldo_caja_chica),this.change_facturacion(),n.series.forEach((e=>{o.agregar_serie_facturacion(e)})),this.id=n.id,this.action_submit="save",t.find('div[name="modal-save"]').modal("show")},delete:function(e){let a="delete",n=t.find('form[name="'+a+'"]');t.find('h4[name="'+a+'"]').text("Eliminar Local"),HELPER.reset_form(n);let i=HELPER.get_attr_json(e);n.find('div[name="texto"]').text(i.email),this.id=i.id,this.action_submit=a,t.find('div[name="modal-'+a+'"]').modal("show")},submit:function(){let e=HELPER.ladda(i+' form[name="'+this.action_submit+'"] button[type="submit"]'),a=new FormData(document.querySelector(i+' form[name="'+this.action_submit+'"]'));null!=this.id&&a.append("id",this.id),a.append("detalle_serie_facturacion",JSON.stringify(this.get_datajson_serie_facturacion())),axios({method:"post",url:BASE_API+"configuracion/local/"+this.action_submit,data:a}).then((function(a){o.table.ajax.reload(null,!1),t.find('div[name="modal-'+o.action_submit+'"]').modal("hide"),HELPER.notificacion(a.data.mensaje,"success"),e.stop()})).catch((a=>{e.stop()}))}};const l=o}}]);