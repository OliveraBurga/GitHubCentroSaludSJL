"use strict";(self.webpackChunkpoliclinico=self.webpackChunkpoliclinico||[]).push([[123],{123:(n,a,e)=>{let t,o;e.r(a),e.d(a,{default:()=>l});let i={render:async n=>{$("#main").off(),n.innerHTML='\n \n         <div id="main">\n             \x3c!-- Content Header (Page header) --\x3e\n             <section class="content-header">\n                 <div class="row">\n                     <div class="col-md-8 content-header" style="padding-top:5px;">\n                         <h1 style="margin:0; ">\n                             Pago de Atención\n                             <small>Tesoreria</small>\n                         </h1>\n                     </div>\n                    <div class="col-md-4" align="right">\n                         <button type="button" class="btn btn-sm btn-warning" name="nuevo"><i class="fa fa-plus"></i> Nuevo</button>\n                     </div>\n                 </div>\n                 </section>\n \n                 \x3c!-- Main content --\x3e\n                 <section class="content">\n \n                 \x3c!-- Default box --\x3e\n                 <div class="box box-warning">\n                   <div class="box-body">\n                     <div class="row">        \n                       <div class="col-md-2">\n                         <div class="form-group">\n                             <label>Fecha Desde</label>\n                             <input type="date" name="fecha_inicio" id="fecha_inicio" class="form-control" autocomplete="off">\n                         </div>\n                       </div>\n                       <div class="col-md-2">\n                         <div class="form-group">\n                             <label>Fecha Hasta</label>\n                             <input type="date" name="fecha_fin" id="fecha_fin" class="form-control" autocomplete="off">\n                         </div>\n                       </div>\n                       <div class="col-md-1" style="padding-top:19px;">\n                         <button class="btn btn-warning" name="update_datatable"><i class="fa fa-search"></i> Buscar</button>\n                       </div>\n                     </div>\n                   </div>\n                 </div>\n                 \x3c!-- /.box --\x3e\n \n                 \x3c!-- Default box --\x3e\n                 <div class="box box-warning">\n                     <div class="box-body">\n                         <div class="table-responsive">\n                             <table name="registros" class="table table-striped" style="width:100%;"></table>\n                         </div>\n                     </div>\n                 </div>\n                 \x3c!-- /.box --\x3e\n \n             </section>\n             \x3c!-- /.content --\x3e\n \n             \x3c!-- MODAL SAVE --\x3e\n             <div class="modal inmodal fade" name="modal-save" data-backdrop="static"  role="dialog" aria-hidden="true">\n                 <div class="modal-dialog modal-xl">\n                     <div class="modal-content">\n                         <div class="modal-header">\n                             <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>\n                             <h4 name="save" class="modal-title">Modal title</h4>\n                         </div>\n                         <form name="save">\n                             <input type="hidden" name="id_moneda" />\n                             <div class="modal-body" style="height: 75vh; overflow-x:auto;">\n                                 <div class="row">\n                                     <div class="col-md-8">\n                                         <div class="row">\n                                             <div class="col-md-12">\n                                                 <table class="table">\n                                                     <thead>\n                                                         <tr>\n                                                             <th>FECHA</th>\n                                                             <th>ATENCION</th>\n                                                            \n                                                             <th>CLIENTE</th>\n                                                             <th>SERVICIO</th>\n                                                             <th>TOTAL SERVICIO</th>   \n                                                   \n                                                             <th>TOTAL DEUDA</th>\n                                                             <th></th>\n                                                         </tr>\n                                                     </thead>\n                                                     <tbody name="detalle-atencion"></tbody>\n                                                     <tfoot>\n                                                         <tr>\n                                                             <td><button type="button" name="mostrar_atencion" class="btn btn-secondary"><i class="fa fa-plus"></i> Agregar</button></td>\n                                                         </tr>\n                                                     </tfoot>\n                                                 </table>\n                                             </div>\n                                             <div class="col-md-6">\n                                             </div>\n                                           \n                                             <div class="col-md-3">\n                                                 <div class="form-group">\n                                                     <label>Importe Total de Deuda<span class="text-red">(*)</span></label>\n                                                     <input type="number" step="any" name="total_importe" class="form-control" autocomplete="off" readonly>        \n                                                 </div>\n                                             </div>  \n                                         </div>\n                                     </div>\n                                     <div class="col-md-4">\n                                         <div class="row">\n                                             <div class="col-md-12">\n                                                 <h4 style="font-weight:bold; text-align:center; ">DATOS DEL PAGO</h4>\n                                             </div>\n                                             <div class="col-md-12">\n                                                 <div class="form-group">\n                                                     <label>Fecha <span class="text-red">(*)</span></label>\n                                                     <input type="date" name="fecha" class="form-control" autocomplete="off">        \n                                                 </div>\n                                             </div>\n                                             <div class="col-md-6">\n                                                 <div class="form-group">\n                                                     <label>Tipo Canal <span class="text-red">(*)</span></label>\n                                                     <select name="tipo_canal" class="form-control select" autocomplete="off">\n                                                         <option value="">Seleccione...</option>\n                                                         <option value="OFICINA">OFICINA</option>\n                                                         <option value="AGENCIA">AGENCIA</option>\n                                                         <option value="VENTANILLA">VENTANILLA</option>\n                                                     </select>    \n                                                 </div>\n                                             </div>\n                                             <div class="col-md-6">\n                                                 <div class="form-group">\n                                                     <label>Medio Pago <span class="text-red">(*)</span></label>\n                                                     <select name="medio_pago" class="form-control select" autocomplete="off">\n                                                         <option value="">Seleccione...</option>\n                                                         <option value="EFECTIVO">EFECTIVO</option>\n                                                         <option value="DEPOSITO">DEPOSITO</option>\n                                                         <option value="TRANSFERENCIA">TRANSFERENCIA</option>\n                                                     </select>    \n                                                 </div>\n                                             </div>\n                                             <div class="col-md-12">\n                                                 <div class="form-group">\n                                                     <label>Número Operación / Referencia <span class="text-red">(*)</span></label>\n                                                     <input type="text" name="numero_operacion" class="form-control" autocomplete="off">        \n                                                 </div>\n                                             </div>\n                                             <div class="col-md-12">\n                                                 <div class="form-group">\n                                                     <label>Monto a Pagar <span class="text-red">(*)</span></label>\n                                                     <input type="number" step="any" name="monto_pago" class="form-control" autocomplete="off">        \n                                                 </div>\n                                             </div>\n                                             <div class="col-md-12">\n                                                 <div class="form-group">\n                                                     <label>Cuenta Bancaria de destino (Empresa) <span class="text-red">(*)</span></label>\n                                                     <select name="id_cuenta_bancaria_empresa" data-select="CUENTA_BANCARIA_EMPRESA" class="form-control" autocomplete="off"></select> \n                                                 </div>\n                                             </div>\n                                             <div class="col-md-12">\n                                                 <div class="form-group">\n                                                     <label>Observación / Detalle</label>\n                                                     <input type="text" name="observacion" class="form-control" autocomplete="off">        \n                                                 </div>\n                                             </div>\n                                             <div class="col-md-12" name="contenedor-aviso"></div>\n                                         </div>\n                                     </div>\n                                 </div>                          \n                             </div>\n                             <div class="modal-footer" align="center" style="display:block">\n                                 <button type="button" name="cerrar" class="btn btn-white pull-left" data-dismiss="modal">Cerrar</button>\n                                 <button type="button" name="submit" class="btn btn-primary">Guardar</button>\n                             </div>\n                         </form>\n                     </div>\n                 </div>\n             </div>\n \n             \x3c!-- MODAL EDIT --\x3e\n             <div class="modal inmodal fade" name="modal-edit" data-backdrop="static" tabindex="-1" role="dialog" aria-hidden="true">\n                 <div class="modal-dialog ">\n                     <div class="modal-content">\n                         <div class="modal-header">\n                             <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button>\n                             <h4 name="edit" class="modal-title">Modal title</h4>\n                         </div>\n                         <form name="edit">\n                             <div class="modal-body">\n                                 <div class="row">\n                                     <div class="col-md-12">\n                                         <h4 style="font-weight:bold; text-align:center; ">DATOS DEL PAGO</h4>\n                                     </div>\n                                     <div class="col-md-12">\n                                         <div class="form-group">\n                                             <label>Fecha <span class="text-red">(*)</span></label>\n                                             <input type="date" name="fecha" class="form-control" autocomplete="off">        \n                                         </div>\n                                     </div>\n                                     <div class="col-md-6">\n                                         <div class="form-group">\n                                             <label>Tipo Canal <span class="text-red">(*)</span></label>\n                                             <select name="tipo_canal" class="form-control select" autocomplete="off">\n                                                 <option value="">Seleccione...</option>\n                                                 <option value="OFICINA">OFICINA</option>\n                                                 <option value="AGENCIA">AGENCIA</option>\n                                                 <option value="VENTANILLA">VENTANILLA</option>\n                                             </select>    \n                                         </div>\n                                     </div>\n                                     <div class="col-md-6">\n                                         <div class="form-group">\n                                             <label>Medio Pago <span class="text-red">(*)</span></label>\n                                             <select name="medio_pago" class="form-control select" autocomplete="off">\n                                                 <option value="">Seleccione...</option>\n                                                 <option value="EFECTIVO">EFECTIVO</option>\n                                                 <option value="DEPOSITO">DEPOSITO</option>\n                                                 <option value="TRANSFERENCIA">TRANSFERENCIA</option>\n                                             </select>    \n                                         </div>\n                                     </div>\n                                     <div class="col-md-12">\n                                         <div class="form-group">\n                                             <label>Número Operación / Referencia <span class="text-red">(*)</span></label>\n                                             <input type="text" name="numero_operacion" class="form-control" autocomplete="off">        \n                                         </div>\n                                     </div>\n                                     <div class="col-md-12">\n                                         <div class="form-group">\n                                             <label>Monto a Pagar <span class="text-red">(*)</span></label>\n                                             <input type="number" step="any" name="monto_pago" class="form-control" autocomplete="off">        \n                                         </div>\n                                     </div>\n                                     <div class="col-md-12">\n                                         <div class="form-group">\n                                             <label>Cuenta Bancaria de destino (Empresa) <span class="text-red">(*)</span></label>\n                                             <select name="id_cuenta_bancaria_empresa" data-select="CUENTA_BANCARIA_EMPRESA" class="form-control" autocomplete="off"></select> \n                                         </div>\n                                     </div>\n                                     <div class="col-md-12">\n                                         <div class="form-group">\n                                             <label>Observación / Detalle</label>\n                                             <input type="text" name="observacion" class="form-control" autocomplete="off">        \n                                         </div>\n                                     </div>\n                                 </div>\n                             </div>\n                             <div class="modal-footer" align="center" style="display:block" >\n                                 <button type="button" name="cerrar" class="btn btn-white" data-dismiss="modal">Cerrar</button>\n                                 <button type="submit" name="submit" class="btn btn-danger">Guardar Cambios</button>\n                             </div>\n                         </form>\n                     </div>\n                 </div>\n             </div>\n \n             \x3c!-- MODAL DELETE --\x3e\n             <div class="modal inmodal fade" name="modal-delete" data-backdrop="static" tabindex="-1" role="dialog" aria-hidden="true">\n                 <div class="modal-dialog modal-sm">\n                     <div class="modal-content">\n                         <div class="modal-header">\n                             <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button>\n                             <h4 name="delete" class="modal-title">Modal title</h4>\n                         </div>\n                         <form name="delete">\n                             <div class="row">\n                                 <div class="col-md-12" align="center">\n                                     <i class="fad fa-trash-alt fa-4x"></i><br/>\n                                 </div>\n                                 <div class="col-md-12"  align="center" style="padding-top:10px;">\n                                     <label><input type="checkbox" name="confirmacion" required/>\n                                         Confirmo realizar la eliminación</label>\n                                     <p style="color:red;">Esta acción no se podrá revertir</p>\n                                 </div>\n                                 <div class="col-md-12" name="texto" align="center"></div>\n                             </div>\n                             <div class="modal-footer" align="center" style="display:block" >\n                                 <button type="button" name="cerrar" class="btn btn-white" data-dismiss="modal">Cerrar</button>\n                                 <button type="submit" name="submit" class="btn btn-danger">Eliminar Ahora!</button>\n                             </div>\n                         </form>\n                     </div>\n                 </div>\n             </div>\n \n             \x3c!-- MODAL ATENCION --\x3e\n             <div class="modal inmodal fade" name="modal-atencion" data-backdrop="static" tabindex="-1" role="dialog" aria-hidden="true">\n                 <div class="modal-dialog modal-xl">\n                     <div class="modal-content" >\n                         <div class="modal-header">\n                             <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button>\n                             <h4 class="modal-title">Servicios pendientes de Pago</h4>\n                         </div>\n                         <div class="modal-body" style="height: 75vh; overflow-x:auto;">\n                             <div class="row">\n                                 <div class="col-md-12">\n                                     <table name="registros_atencion" class="table table-striped nowrap" style="width:100%;"></table>\n                                 </div>\n                             </div>\n                         </div>                        \n                         <div class="modal-footer" align="center" style="display:block" >\n                             <button type="button" name="cerrar" class="btn btn-white pull-left" data-dismiss="modal">Cerrar</button>\n                             <label class="pull-left" style="margin-top:5px; margin-left:10px;"> \n                                 <input type="checkbox" name="select_all_orden">\n                                 Seleccionar Todas las Órdenes\n                             </label>\n \n                             <button type="button" name="agregar_a_pago" class="btn btn-primary">Agregar a Lista de Pagos</button>\n                         </div>\n                     </div>\n                 </div>\n             </div>\n         \n \n         </div>            \n         ',i.after_render()},after_render:async()=>{o="#main",t=$(o),t.find('form[name="save"]').validate({rules:{id_moneda:{required:!0},fecha:{required:!0},tipo_canal:{required:!0},medio_pago:{required:!0},monto_pago:{required:!0},numero_operacion:{required:!0},id_cuenta_bancaria_empresa:{required:!0}},messages:{id_moneda:"Moneda",fecha:"Fecha",tipo_canal:"Tipo de Canal",medio_pago:"Medio de Pago",monto_pago:"Monto a Pagar",numero_operacion:"Número de Operación / Referencia",id_cuenta_bancaria_empresa:"Cuenta bancaria de destino (Empresa)"}}),t.on("click",'form[name="save"] button[name="submit"]',(function(n){n.stopImmediatePropagation(),t.find('form[name="save"]').valid()&&i.submit()})),t.find('form[name="edit"]').validate({rules:{fecha:{required:!0},tipo_canal:{required:!0},medio_pago:{required:!0},monto_pago:{required:!0},numero_operacion:{required:!0},id_cuenta_bancaria_empresa:{required:!0}},messages:{fecha:"Fecha",tipo_canal:"Tipo de Canal",medio_pago:"Medio de Pago",monto_pago:"Monto a Pagar",numero_operacion:"Número de Operación / Referencia",id_cuenta_bancaria_empresa:"Cuenta bancaria de destino (Empresa)"},submitHandler:function(){i.submit_operacion()}}),t.on("click",'button[name="update_datatable"]',(function(n){n.stopImmediatePropagation(),i.table.ajax.reload(null,!1)})),t.find('form[name="delete"]').validate({submitHandler:function(){i.submit_operacion()}}),t.find('button[name="mostrar_atencion"]').click((function(n){i.mostrar_atencion()})),t.find('input[name="select_all_orden"]').change((function(n){i.select_all_orden()})),t.find('button[name="agregar_a_pago"]').click((function(n){i.agregar_a_pago()})),t.on("click",'button[name="quitar_atencion"]',(function(n){n.stopImmediatePropagation(),i.quitar_atencion($(this))})),t.on("click",'button[name="nuevo"]',(function(n){n.stopImmediatePropagation(),i.new()})),t.on("click",'button[name="row-print"]',(function(n){n.stopImmediatePropagation();let a=HELPER.get_attr_json($(this));i.print(a.id)})),t.on("click",'a[name="row-edit"]',(function(n){n.stopImmediatePropagation(),i.edit($(this))})),t.on("click",'a[name="row-delete"]',(function(n){n.stopImmediatePropagation(),i.delete($(this))})),t.find('select[name="medio_pago"]').change((function(n){i.change_medio_pago(this.value)})),t.find('input[name="fecha_inicio"]').val(HELPER.primer_dia_mes()),t.find('input[name="fecha_fin"]').val(HELPER.fecha_actual()),i.datatable(),i.datatable_atencion(),HELPER.load_component()},id:null,action_submit:null,imagen_anterior:null,fl_auto_event:!0,id_moneda_deuda:null,change_medio_pago:n=>{"EFECTIVO"!=n?(t.find('select[name="id_cuenta_bancaria_empresa"]').prop("disabled",!1),i.select_cuenta_bancaria_empresa()):t.find('select[name="id_cuenta_bancaria_empresa"]').prop("disabled",!0)},mostrar_atencion:(n=null)=>{i.table_orden.ajax.reload(null,!1),t.find('div[name="modal-atencion"]').modal("show"),setInterval((()=>{$($.fn.dataTable.tables(!0)).DataTable().columns.adjust()}),100)},select_all_orden:()=>{t.find('input[name="select_all_orden"]').is(":checked")?t.find('input[name="check_orden"]').prop("checked",!0):t.find('input[name="check_orden"]').prop("checked",!1)},quitar_atencion:n=>{var a=n.parents("tr")[0].dataset.codigo_agregado;$('tr[data-codigo_agregado="'+a+'"]').remove(),i.calcular_total_importe()},orden_json:()=>{let n=[];return t.find('tbody[name="detalle-atencion"] tr').each((function(){let a=JSON.parse(JSON.stringify($(this).data("json"))),e={id:a.id,total_deuda:a.total_deuda};n.push(e)})),n},datatable_atencion:function(){this.table_orden=t.find('table[name="registros_atencion"]').DataTable({ajax:BASE_API+"tesoreria/atencion_pago/servicio_pendiente",scrollY:!1,columns:[{title:"",defaultContent:"",render:function(n,a,e){return'<input type="checkbox" name="check_orden" />'}},{title:"FECHA",render:function(n,a,e){return HELPER.fecha(e.fecha)}},{title:"ATENCION",mData:"atencion"},{title:"CLIENTE",mData:"cliente"},{title:"SERVICIO",mData:"servicio"},{title:"TOTAL SERVICIO",render:function(n,a,e){return e.moneda_atencion+" "+e.importe},class:"text-right"},{title:"TOTAL PAGOS",mData:"total_pago",class:"text-right"},{title:"TOTAL DEUDA",render:function(n,a,e){return e.moneda_deuda+" "+e.total_deuda},class:"text-right"}],createdRow:function(n,a,e){$(n).attr("data-json",JSON.stringify(a)),0==a.fl_estado&&($(n).css("text-decoration","line-through"),$(n).css("color","red"))}})},agregar_a_pago:()=>{t.find('table[name="registros_atencion"] tr').each((function(){if($(this).find("input[type=checkbox]").prop("checked")){let n=JSON.parse(JSON.stringify($(this).data("json")));i.agregar_orden(n)}})),t.find('div[name="modal-atencion"]').modal("hide"),i.calcular_total_importe()},agregar_orden:n=>{let a='\n             <tr data-codigo_agregado="'+n.id+"\" data-json='"+JSON.stringify(n)+"'>\n                 <td>"+HELPER.fecha(n.fecha)+"</td>\n                 <td>"+n.atencion+"</td>\n               \n                 <td>"+(null!=n.cliente?n.cliente:"")+"</td>\n                 <td>"+(null!=n.servicio?n.servicio:"")+'</td>\n                 <td style="text-align:right;">'+(null!=n.total_atencion?n.moneda_atencion+" "+n.total_atencion:n.moneda_atencion+" 0.00")+'</td>               \n \n                 <td style="text-align:right;">'+n.moneda_deuda+" "+n.total_deuda+'</td>\n                 <td><button type="button" name="quitar_atencion" class="btn btn-danger btn-sm"><i class="fa fa-times"></i></button></td>\n             </tr>\n         ',e=0;t.find('tbody[name="detalle-atencion"] tr').each((function(){JSON.parse(JSON.stringify($(this).data("json"))).id==data_orden.id&&e++})),0==e?t.find('tbody[name="detalle-atencion"]').append(a):HELPER.notificacion("Hubo Servicios que no se agregaron, porque ya estaban agregaos anteriormente","warning")},calcular_total_importe:async()=>{let n=0,a=[];t.find('tbody[name="detalle-atencion"] tr').each((function(){let e=JSON.parse(JSON.stringify($(this).data("json"))),t=!1;a.forEach((n=>{console.log(n+" "+e.factura),n==e.factura&&(t=!0)})),a.push(e.factura),n+=parseFloat(e.total_deuda)})),n=Math.round(100*n)/100,t.find('input[name="total_importe"]').val(n.toFixed(2)),i.validar_moneda()},validar_moneda:()=>{let n=null,a=!1;t.find('tbody[name="detalle-atencion"] tr').each((function(){let e=JSON.parse(JSON.stringify($(this).data("json")));null!=n&&n!=e.id_moneda_deuda&&(a=!0),n=e.id_moneda_deuda})),1==a?(t.find('button[name="submit"]').prop("disabled",!0),t.find('div[name="contenedor-aviso"]').html('\n                 <div class="callout callout-info">\n                     <h4>Atención!</h4>\n                     <p>No puede realizar pagos con diversos tipos de monedas a la vez.</p>\n                 </div>\n             '),t.find('input[name="id_moneda"]').val("")):(t.find('button[name="submit"]').prop("disabled",!1),t.find('div[name="contenedor-aviso"]').html(""),t.find('input[name="id_moneda"]').val(n),i.id_moneda_deuda=n)},print:async n=>{await axios.get(BASE_API+"tesoreria/atencion_pago/print/"+n).then((function(n){let a=n.data,e='<div style="width:300px; margin:auto;">\n \n             <div style="text-align:center;"><img src="'+BASE_FILES+"images/"+a.logo+'" style="max-width:200px;"/></div>\n             <div style="text-align:center; font-size:15px; font-weight:bold; margin-top:10px;">'+a.empresa+'</div>\n             <div style="font-weight:bold; text-align:center; font-size:17px; margin-top:10px;">------- TICKET DE PAGO -------</div>\n             <div style="text-align:center;  font-size:15px;">ATENCION: '+a.atencion+'</div>\n             <div style="text-align:center;">'+HELPER.fecha(a.fecha)+'</div>\n \n             <table style="width:100%;">                \n                 <tr>\n                     <td>TIPO CANAL:</td>\n                     <td style="text-align:right;">'+a.tipo_canal+'</td>\n                 </tr>\n                 <tr>\n                     <td>MEDIO DE PAGO:</td>\n                     <td style="text-align:right;">'+a.medio_pago+'</td>\n                 </tr>\n                 <tr>\n                     <td>NÚM. OP / REFERENCIA:</td>\n                     <td style="text-align:right;">'+a.numero_operacion+'</td>\n                 </tr>\n                 <tr>\n                     <td>CANT. PAGOS:</td>\n                     <td style="text-align:right;">'+a.cantidad_pagos+'</td>\n                 </tr>\n                 <tr>\n                     <td colspan="2" style="text-align:center;"><span style="font-size:16px;">--------------------------------------------------</span></td>\n                 </tr>\n                 <tr>\n                     <td style="font-weight:bold; font-size:14px;">MONTO:</td>\n                     <td style="font-weight:bold; text-align:right; font-size:14px;">'+a.moneda_pago+" "+a.monto+'</td>\n                 </tr>\n                 <tr>\n                     <td>OBSERVACIÓN:</td>\n                     <td style="text-align:right;">'+a.observacion+'</td>\n                 </tr>\n                 <tr>\n                     <td>USUARIO:</td>\n                     <td style="text-align:right;">'+a.usuario+"</td>\n                 </tr>\n                 \n             </table>\n \n             </div>";HELPER.print(e)})).catch((n=>{console.log(n)}))},select_cuenta_bancaria_empresa:async(n=null)=>{null==n&&(n=i.id_moneda_deuda);let a=t.find('select[data-select="CUENTA_BANCARIA_EMPRESA"]');a.empty(),a.append($("<option></option>").attr("value","").text("Seleccionar...")),null!=n&&await axios.get(BASE_API+"configuracion/cuenta_bancaria_empresa/get_select?id_moneda="+n).then((function(n){n.data.forEach((n=>{a.append('<option value="'+n.id+'">'+n.text+"</option>")})),a.select2()})).catch((n=>{console.log(n)}))},datatable:function(){this.table=t.find('table[name="registros"]').DataTable({ajax:{url:BASE_API+"tesoreria/atencion_pago",data:function(n){n.fecha_inicio=t.find('input[name="fecha_inicio"]').val(),n.fecha_fin=t.find('input[name="fecha_fin"]').val()}},columns:[{title:"ACCIÓN",defaultContent:"",render:function(n,a,e){return'\n                             <div class="btn-group">\n                                 <button type="button" class="btn btn-default btn-sm" name="row-print">VISUALIZAR</button>     \n                                 <button type="button" class="btn btn-default btn-sm dropdown-toggle" data-toggle="dropdown">\n                                       <i class="fa fa-angle-down"></i>\n                                 </button>\n                                 <ul class="dropdown-menu dropdown-menu-left" role="menu">\n                                     <li><a class="dropdown-item" name="row-edit" href="javascript:"><i class="far fa-pencil"></i> Editar</a></li>\n                                     <li><a class="dropdown-item" name="row-delete" href="javascript:"><i class="far fa-ban"></i> Eliminar</a></li>\n                                 </ul>\n                             </div>\n                         '},width:"100px"},{title:"FECHA",render:function(n,a,e){return HELPER.fecha(e.fecha)}},{title:"ATENCION",mData:"atencion"},{title:"TOTAL ATENCION",render:function(n,a,e){return e.moneda_atencion+" "+e.importe},class:"text-right"},{title:"MONTO PAGO",render:function(n,a,e){return e.moneda_pago+" "+e.monto},class:"text-right"},{title:"TIPO CANAL",mData:"tipo_canal"},{title:"MEDIO PAGO",mData:"medio_pago"},{title:"NÚMERO DE OPERACIÓN",mData:"numero_operacion"},{title:"OBSERVACIÓN",mData:"observacion"}]})},new:function(){let n=t.find('form[name="save"]');t.find('h4[name="save"]').text("Nuevo Pago"),HELPER.reset_form(n),this.id=null,this.action_submit="save",t.find('tbody[name="detalle-atencion"').html(""),t.find('div[name="modal-save"]').modal("show")},edit:async n=>{let a=t.find('form[name="edit"]');t.find('h4[name="edit"]').text("Editar Pago"),HELPER.reset_form(a);let e=HELPER.get_attr_json(n);a.find('input[name="fecha"]').val(e.fecha),a.find('select[name="tipo_canal"]').val(e.tipo_canal).change(),a.find('select[name="medio_pago"]').val(e.medio_pago).change(),await i.select_cuenta_bancaria_empresa(e.id_moneda),a.find('input[name="numero_operacion"]').val(e.numero_operacion),a.find('input[name="monto_pago"]').val(e.monto),a.find('select[name="id_cuenta_bancaria_empresa"]').val(e.id_cuenta_bancaria_empresa).change(),a.find('input[name="observacion"]').val(e.observacion),i.id=e.id,i.action_submit="edit",t.find('div[name="modal-edit"]').modal("show")},delete:function(n){let a="delete",e=t.find('form[name="'+a+'"]');t.find('h4[name="'+a+'"]').text("Eliminar Pago"),HELPER.reset_form(e);let o=HELPER.get_attr_json(n);e.find('div[name="texto"]').text(o.monto+" / Atencion: "+o.atencion),this.id=o.id,this.action_submit=a,t.find('div[name="modal-'+a+'"]').modal("show")},submit:function(){let n=HELPER.ladda(o+' form[name="'+this.action_submit+'"] button[name="submit"]'),a=new FormData(document.querySelector(o+' form[name="'+this.action_submit+'"]'));null!=this.id&&a.append("id",this.id),i.orden_json().length>0?(a.append("detalle_atencion",JSON.stringify(i.orden_json())),axios({method:"post",url:BASE_API+"tesoreria/atencion_pago/"+this.action_submit,data:a}).then((function(a){i.table.ajax.reload(null,!1),t.find('div[name="modal-'+i.action_submit+'"]').modal("hide"),HELPER.notificacion(a.data.mensaje,"success"),n.stop()})).catch((a=>{n.stop()}))):(HELPER.notificacion("No exite servicios agregados","warning"),n.stop())},submit_operacion:function(){let n=HELPER.ladda(o+' form[name="'+this.action_submit+'"] button[name="submit"]'),a=new FormData(document.querySelector(o+' form[name="'+this.action_submit+'"]'));null!=this.id&&a.append("id",this.id),axios({method:"post",url:BASE_API+"tesoreria/atencion_pago/"+this.action_submit,data:a}).then((function(a){i.table.ajax.reload(null,!1),t.find('div[name="modal-'+i.action_submit+'"]').modal("hide"),HELPER.notificacion(a.data.mensaje,"success"),n.stop()})).catch((a=>{n.stop()}))}};const l=i}}]);