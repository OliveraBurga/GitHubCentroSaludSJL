"use strict";(self.webpackChunkpoliclinico=self.webpackChunkpoliclinico||[]).push([[413],{413:(n,e,a)=>{a.r(e),a.d(e,{default:()=>l});var t=a(856);let i,o,s={modal:()=>'\n        \x3c!-- MODAL SAVE --\x3e\n        <div class="modal inmodal fade" name="modal-save" data-backdrop="static"  role="dialog" aria-hidden="true">\n            <div class="modal-dialog modal-lg">\n                <div class="modal-content">\n                    <div class="modal-header">\n                        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>\n                        <h4 name="save" class="modal-title">Modal title</h4>\n                    </div>\n                    <form name="save">\n                        <div class="modal-body">\n                            <div class="row">   \n                                <div class="col-md-4" data-name="contenedor-tipo_tarifa">\n                                    <div class="form-group">\n                                        <label>Tipo Tarifa <span class="text-red">(*)</span></label>\n                                        <select name="tipo_tarifa" class="form-control select" autocomplete="off" required>\n                                            <option value="">Seleccione...</option>\n                                            <option value="ANALISIS CLINICO">ANALISIS CLINICO</option>\n                                            <option value="CONSULTA MEDICA">CONSULTA MEDICA</option>\n                                            <option value="PACIENTE">PACIENTE</option>\n                                            <option value="SERVICIO-PACIENTE">SERVICIO - PACIENTE</option>\n                                        </select>\n                                    </div>\n                                </div>    \n                                <div class="col-md-8" data-contenedor_form="paciente" style="display: none;">\n                                    <div class="form-group">\n                                        <label>Paciente <span class="text-red">(*)</span></label>\n                                        <select class="form-control" name="id_paciente"  data-select="PACIENTE" required></select>\n                                    </div>\n                                </div>\n                                <div class="col-md-8" data-contenedor_form="servicio" style="display: none;">\n                                    <div class="form-group">\n                                        <label>Servicio <span class="text-red">(*)</span></label> <a name="nuevo_servicio" href="javascript:" style="float:right; display: none;">Crear Nuevo</a>\n                                        <select name="id_servicio" data-select="SERVICIO" class="form-control" autocomplete="off" required></select>\n                                    </div>\n                                </div>\n                                <div class="col-md-4">\n                                    <div class="form-group">\n                                        <label>Precio  </label>\n                                        <div class="input-group">\n                                            <span class="input-group-addon">'+GLOBAL.moneda_sistema.simbolo+'</span>\n                                            <input type="number" name="precio" class="form-control" autocomplete="off" required>\n                                        </div>                                   \n                                    </div>\n                                </div> \n                                <div class="col-md-4">\n                                    <div class="form-group">\n                                        <label>Precio Convenio </label>\n                                        <div class="input-group">\n                                            <span class="input-group-addon">'+GLOBAL.moneda_sistema.simbolo+'</span>\n                                            <input type="number" name="precio_convenio" class="form-control" autocomplete="off" required>\n                                        </div>                                   \n                                    </div>\n                                </div> \n                            </div>                              \n                        </div>\n                        <div class="modal-footer" align="center" style="display:block">\n                            <button type="button" name="cerrar" class="btn btn-white pull-left" data-dismiss="modal">Cerrar</button>\n                            <button type="submit" name="submit" class="btn btn-primary">Guardar</button>\n                        </div>\n                    </form>\n                </div>\n            </div>\n        </div>\n\n            \n        ',render:async(n,e=!1)=>{s.parent_comp=e;let a="main_"+Math.random().toString(36).substr(2);$("#"+a).off(),0!=e?n.html('\n                <div id="'+a+'">'+s.modal(!0)+'</div> \n                <div name="componente-servicio"></div>\n            '):n.innerHTML='\n\n                <div id="'+a+'">\n                    \x3c!-- Content Header (Page header) --\x3e\n                    <section class="content-header">\n                        <div class="row">\n                            <div class="col-md-6 content-header" style="padding-top:5px;">\n                                <h1 style="margin:0; ">\n                                    Tarifas\n                                    <small>Configuración</small>\n                                </h1>\n                            </div>\n                            <div class="col-md-6" align="right">\n                                <button type="button" class="btn btn-sm btn-info" name="nuevo"><i class="fa fa-plus"></i> Nuevo</button>\n                            </div>\n                        </div>\n                    </section>\n\n                    \x3c!-- Main content --\x3e\n                    <section class="content">\n\n                        \x3c!-- Default box --\x3e\n                        <div class="box box-info" >\n                            <div class="box-body">\n                                <div class="row">                                    \n                                    <div class="col-md-2">\n                                        <div class="form-group">\n                                            <label>Tipo Tarifa </label>\n                                            <select class="form-control" data-filtro="tipo_tarifa">\n                                                <option value="">TODOS</option>\n                                                <option value="ANALISIS CLINICO">ANALISIS CLINICO</option>\n                                                <option value="CONSULTA MEDICA">CONSULTA MEDICA</option>\n                                                <option value="PACIENTE">PACIENTE</option>\n                                                <option value="SERVICIO-PACIENTE">SERVICIO - PACIENTE</option>\n                                            </select>\n                                        </div>\n                                    </div>\n                                    <div class="col-md-1" style="padding-top:20px;">\n                                        <button type="button" class="btn btn-sm btn-info" name="btn_buscar"><i class="fa fa-search"></i> Buscar</button>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                        \x3c!-- /.box --\x3e\n\n                        \x3c!-- Default box --\x3e\n                        <div class="box box-info">\n                            <div class="box-body">\n                            <div class="table-responsive">\n                                <table name="registros" class="table table-striped nowrap" style="width:100%;"></table>\n                            </div>\n                            </div>\n                        </div>\n                        \x3c!-- /.box --\x3e\n\n                    </section>\n                    \x3c!-- /.content --\x3e\n\n                    '+s.modal()+'\n\n                    \x3c!-- MODAL DELETE --\x3e\n                    <div class="modal inmodal fade" name="modal-delete" data-backdrop="static" tabindex="-1" role="dialog" aria-hidden="true">\n                        <div class="modal-dialog modal-sm">\n                            <div class="modal-content">\n                                <div class="modal-header">\n                                    <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button>\n                                    <h4 name="delete" class="modal-title">Modal title</h4>\n                                </div>\n                                <form name="delete">\n                                    <div class="row">\n                                        <div class="col-md-12" align="center">\n                                            <i class="fad fa-trash-alt fa-4x"></i><br/>\n                                        </div>\n                                        <div class="col-md-12"  align="center" style="padding-top:10px;">\n                                            <label><input type="checkbox" name="confirmacion" required/>\n                                                Confirmo realizar la eliminación</label>\n                                            <p style="color:red;">Esta acción no se podrá revertir</p>\n                                        </div>\n                                        <div class="col-md-12" name="texto" align="center">\n\n                                        </div>\n                                    </div>\n                                    <div class="modal-footer" align="center" style="display:block" >\n                                        <button type="button" name="cerrar" class="btn btn-white" data-dismiss="modal">Cerrar</button>\n                                        <button type="submit" name="submit" class="btn btn-danger">Eliminar Ahora!</button>\n                                    </div>\n                                </form>\n                            </div>\n                        </div>\n                    </div>\n                \n\n                </div>     \n                <div name="componente-servicio"></div>       \n            ',await s.after_render(a),await t.default.render($('div[name="componente-servicio"]'),s.select_servicio)},after_render:async n=>{o="#"+n,i=$(o),i.find('form[name="save"]').validate({submitHandler:function(){s.submit()}}),0==s.parent_comp&&(i.on("click",'button[name="btn_buscar"]',(function(n){n.stopImmediatePropagation(),s.table.ajax.reload(null,!1)})),s.datatable(),i.find('form[name="delete"]').validate({submitHandler:function(){s.submit()}}),i.on("click",'button[name="nuevo"]',(function(n){n.stopImmediatePropagation(),s.new()})),i.on("click",'button[name="row-edit"]',(function(n){n.stopImmediatePropagation(),s.edit($(this))})),i.on("change",'select[name="id_servicio"]',(function(n){n.stopImmediatePropagation(),1==s.fl_evento&&s.consultar_costo()})),i.on("click",'a[name="row-delete"]',(function(n){n.stopImmediatePropagation(),s.delete($(this))}))),i.on("click",'a[name="nuevo_servicio"]',(function(n){n.stopImmediatePropagation(),t.default.new()})),i.on("change",'select[name="tipo_tarifa"]',(function(n){n.stopImmediatePropagation(),s.change_tipo_tarifa_form()})),s.select_paciente(),HELPER.load_component()},id:null,action_submit:null,imagen_anterior:null,id_cliente:null,id_servicio_nuevo:null,fl_evento:!0,change_tipo_tarifa_form:()=>{let n=i.find('form[name="save"]'),e=n.find('select[name="tipo_tarifa"]').val();"ANALISIS CLINICO"==e||"CONSULTA MEDICA"==e?(n.find('div[data-contenedor_form="paciente"]').hide("fast"),n.find('div[data-contenedor_form="servicio"]').show("fast"),n.find('select[name="id_paciente"]').prop("disabled",!0),n.find('select[name="id_servicio"]').prop("disabled",!1),1==s.fl_evento&&s.select_servicio()):"PACIENTE"==e?(n.find('div[data-contenedor_form="paciente"]').show("fast"),n.find('div[data-contenedor_form="servicio"]').hide("fast"),n.find('select[name="id_paciente"]').prop("disabled",!1),n.find('select[name="id_servicio"]').prop("disabled",!0)):"SERVICIO-PACIENTE"==e&&(n.find('div[data-contenedor_form="paciente"]').show("fast"),n.find('div[data-contenedor_form="servicio"]').show("fast"),n.find('select[name="id_paciente"]').prop("disabled",!1),n.find('select[name="id_servicio"]').prop("disabled",!1),1==s.fl_evento&&s.select_servicio())},nuevo_servicio:()=>{s.id_servicio_nuevo=null,t.default.new()},select_paciente:async()=>{i.find('select[data-select="PACIENTE"]').select2({ajax:{url:BASE_API+"configuracion/socio/get_select",dataType:"json",delay:250,data:function(n){return{buscar:n.term}},processResults:function(n,e){return{results:n}},cache:!0},escapeMarkup:function(n){return n},placeholder:"Buscar Nombres o Número de Documento",minimumInputLength:2,language:{inputTooShort:function(n){return"Escriba mas de 2 caracteres"}},allowClear:!0})},select_servicio:async(n=null)=>{let e=i.find('select[data-select="SERVICIO"]'),a=i.find('select[name="tipo_tarifa"]').val();i.find('select[data-select="SERVICIO"]').html(""),e.empty(),e.append($("<option></option>").attr("value","").text("Seleccione...")),"SERVICIO-PACIENTE"==a&&(a="CONSULTA MEDICA"),await axios.get(BASE_API+"configuracion/tipo_servicio/get_select?tipo="+a).then((async function(a){a.data.forEach((n=>{e.append('<option value="'+n.id+'">'+n.text+"</option>")})),e.select2(),null!=n&&(e.val(n).change(),s.id_servicio_nuevo=n)})).catch((n=>{console.log(n)}))},consultar_costo:async()=>{let n=i.find('select[name="id_servicio"]').val();""!=n&&null!=n&&await axios.get(BASE_API+"configuracion/tipo_servicio/get_select_unique/"+n).then((function(n){i.find('input[name="precio"]').val(n.data.costo)})).catch((n=>{console.log(n)}))},datatable:function(){this.table=i.find('table[name="registros"]').DataTable({ajax:{url:BASE_API+"configuracion/tarifa",data:function(n){n.tipo_tarifa=i.find('select[data-filtro="tipo_tarifa"]').val()}},lengthChange:!1,paginate:!1,columns:[{title:"ACCIÓN",defaultContent:"",render:function(n,e,a){return'\n                        <div class="btn-group" style="width:100px;">\n                            <button type="button" class="btn btn-default btn-sm" name="row-edit">EDITAR</button>     \n                            <button type="button" class="btn btn-default btn-sm dropdown-toggle" data-toggle="dropdown">\n                                <i class="fa fa-angle-down"></i>\n                            </button>\n                            <ul class="dropdown-menu dropdown-menu-left" role="menu">\n                                <li><a class="dropdown-item" name="row-delete" href="javascript:"><i class="far fa-trash-alt"></i> Eliminar</a></li>\n                            </ul>\n                        </div>\n                    '},width:"100px"},{title:"TIPO TARIFA",mData:"tipo_tarifa"},{title:"SERVICIO",mData:"servicio"},{title:"PACIENTE",mData:"paciente"},{title:"PRECIO",render:function(n,e,a){return GLOBAL.moneda_sistema.simbolo+" "+a.precio},class:"text-right"},{title:"PRECIO CONVENIO",render:function(n,e,a){return GLOBAL.moneda_sistema.simbolo+" "+a.precio_convenio},class:"text-right"}]})},new:function(n=null){let e=i.find('form[name="save"]');i.find('h4[name="save"]').text("Nueva Tarifa"),HELPER.reset_form(e),e.find('div[data-contenedor_form="paciente"]').hide("fast"),e.find('div[data-contenedor_form="servicio"]').hide("fast"),this.id=null,this.action_submit="save",s.id_servicio_nuevo=null,i.find('div[name="modal-save"]').modal("show")},edit:async function(n,e=!1){let a,t=i.find('form[name="save"]');i.find('h4[name="save"]').text("Editar Tarifa"),HELPER.reset_form(t),a=0==e?HELPER.get_attr_json(n):e,s.fl_evento=!1,t.find('input[name="precio"]').val(a.precio),t.find('input[name="precio_convenio"]').val(a.precio_convenio),t.find('select[name="tipo_tarifa"]').val(a.tipo_tarifa).change(),await s.select_servicio(a.id_servicio),axios.get(BASE_API+"configuracion/socio/get_unique/"+a.id_paciente).then((function(n){t.find('select[name="id_paciente"]').html(""),t.find('select[name="id_paciente"]').append(new Option(n.data.nombre_completo,n.data.id))})).catch((n=>{console.log(n)})),this.id=a.id,this.action_submit="save",s.fl_evento=!0,i.find('div[name="modal-save"]').modal("show")},delete:function(n){let e="delete",a=i.find('form[name="'+e+'"]');i.find('h4[name="'+e+'"]').text("Eliminar Tarifa"),HELPER.reset_form(a);let t=HELPER.get_attr_json(n);a.find('div[name="texto"]').text(t.email),this.id=t.id,this.action_submit=e,i.find('div[name="modal-'+e+'"]').modal("show")},submit:function(){let n=HELPER.ladda(o+' form[name="'+this.action_submit+'"] button[type="submit"]'),e=new FormData(document.querySelector(o+' form[name="'+this.action_submit+'"]'));null!=this.id&&e.append("id",this.id),axios({method:"post",url:BASE_API+"configuracion/tarifa/"+this.action_submit,data:e}).then((function(e){0==s.parent_comp?s.table.ajax.reload(null,!1):s.parent_comp(s.id_servicio_nuevo,!0),i.find('div[name="modal-'+s.action_submit+'"]').modal("hide"),HELPER.notificacion(e.data.mensaje,"success"),n.stop()})).catch((e=>{n.stop()}))}};const l=s}}]);